{% extends 'base.html' %}
{% block title %}Dataset{% endblock%}
{% block content %}
<style>
  table{
    counter-reset: tableCount;
    border-collapse: collapse;
  }
  .counterCell:before {
    content: counter(tableCount);
    counter-increment: tableCount;
  }
  th, td {
    border: 2px solid #636363;
  }
  thead {
    background-color: #b6b6b6;
    border: 2px solid #636363
  }
  tr:nth-child(even) {background-color: #e6e6e6}

  .dropbtn {
    border-radius:8px;
    background-color: #00c5d3;
    color: black;
    padding: 16px;
    font-size: 16px;
    border: 3px solid #ccc;
    cursor: pointer;
  }

  .dropbtn:hover {
    background-color: #338ac4;
  }

  .dropdown {
    position: relative;
    left: 88%;
    bottom: 33px;
    display: inline-block;
    min-width: 160px;
  }

  .dropdown-content {
    border-radius:3px;
    display: none;
    position: absolute;
    background-color: #02d0df;
    min-width: 160px;
    overflow: auto;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
  }

  .dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
  }

  .show {
    display: block;
  }

  .dropdown a:hover, button[name="submit"]:hover, #ddForm:hover, #createNewModel:hover {
    background-color: #338ac4;
  }

  #ddForm, #createNewModel {
    width: 100%;
    margin: auto;
    margin-bottom: 2px;
    padding: 0px;
    border: 3px solid #ccc;
    height: 54.83px;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #02d0df;
    color: black;
  }

  button[name="submit"] {
    background-color: #00000000;
    color: black;
  }

  .arrow {
    border: solid black;
    border-width: 0 3px 3px 0;
    display: inline-block;
    padding: 3px;
    transform: rotate(45deg);
    -webkit-transform: rotate(45deg);
    position: relative;
    left: 6px;
    bottom: 3px;
  }

  .form-popup {
    display: none;
    position: fixed;
    top: 20%;
    left: 39%;
    border: 3px solid #66666696;
    z-index: 9;
  }

  .form-container {
    padding: 12px;
    background-color: white;
    margin: auto;
    min-width: 100%;
    min-height: 100%;
  }

  .btn, .cancel {
    padding: 5px;
    margin-bottom: 3px;
  }

</style>

<div class="content2">
  <h2 style="text-align:center">View Dataset</h2>
</div>

<div class="content2">
    <div class="dropdown">
      <button onclick="dropFunc()" class="dropbtn">Select Model<i class="arrow down"></i></button>
      <div id="myDropdown" class="dropdown-content">
          {% for model in models %}

          <form action="/view/predict/" method="post" id="ddForm">
          {% csrf_token %}
          <input type="hidden" name="model" value={{model.id}}>
          <input type="hidden" name="dataset" value={{dataset}}>
          <!--{{dataset}}-->
          <button name ="submit" value="1" type="submit">{{model.name}}</button>
          </form>

          {% endfor %}
        <button class="open-button" onclick="openForm()" id="createNewModel">Create New Model</button>
      </div>
    </div>

    <div class="form-popup" id="newModelForm">
      <form action="" method="post" class="form-container">
        <h3>Create a New Model</h3><br>

        <label for="modname"><b>Model Name</b></label>
        <input type="text" placeholder="Model Name" name="modname" required>

        <p>
          <br><b>model config settings:</b><br><br>etc ...
          <br><br> etc ... <br><br> etc ... <br><br><br><br><br><br>
        </p>

        <button type="submit" class="btn">Submit</button>
        <button type="button" class="btn cancel" onclick="closeForm()">Close</button>

      </form>
    </div>
    
    <script>
    function dropFunc() {
      document.getElementById("myDropdown").classList.toggle("show");
    }
    // Close the dropdown if the user clicks outside of it
    window.onclick = function(event) {
      if (!event.target.matches('.dropbtn')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    }
    </script>
    <script>
      function openForm() {
        document.getElementById("newModelForm").style.display = "flex";
      }
              
      function closeForm() {
        document.getElementById("newModelForm").style.display = "none";
      }
    </script>
</div>

<div class="table-responsive text-nowrap">
  <table class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">ID</th>
        <th scope="col">TCO</th>
        <th scope="col">TVO</th>
        <th scope="col">NET</th>
        <th scope="col">PP</th>
        <th scope="col">ROI</th>
        <th scope="col">CapEx</th>
        <th scope="col">OneTime</th>
        <th scope="col">OnGoing</th>
        <th scope="col">Revenue</th>
        <th scope="col">Saving</th>
        <th scope="col">Avoid</th>
        <th scope="col">Cost Grade</th>
        <th scope="col">Value Score</th>
        <th scope="col">Risk Score</th>
        <th scope="col">Blended Score</th>
        <th scope="col">Calc Priority</th>
        <th scope="col">Overrided Priority</th>
      </tr>
    </thead>
    <tbody>
      {% for data in sets %}
      <tr>
        <td class="counterCell"></td>
        <td>{{data.name}}</td>
        <td>{{data.TCO}}</td>
        <td>{{data.TVO}}</td>
        <td>{{data.NET}}</td>
        <td>{{data.PP}}</td>
        <td>{{data.ROI}}</td>
        <td>{{data.CapEx}}</td>
        <td>{{data.OneTime}}</td>
        <td>{{data.OnGoing}}</td>
        <td>{{data.Revenue}}</td>
        <td>{{data.Saving}}</td>
        <td>{{data.Avoid}}</td>
        <td>{{data.CostGrade}}</td>
        <td>{{data.ValueScore}}</td>
        <td>{{data.RiskScore}}</td>
        <td>{{data.BlendedScore}}</td>
        <td>{{data.CalcPriority}}</td>
        <td>{{data.OverridedPriority}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}